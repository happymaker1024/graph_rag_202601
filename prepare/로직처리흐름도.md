# ë¡œì§ ì²˜ë¦¬ íë¦„ë„
```mermaid
flowchart TB
    subgraph Input["ğŸ¬ ì…ë ¥"]
        A[("ì‚¬ìš©ì ì§ˆë¬¸<br/>'2ì°¨ ì„¸ê³„ëŒ€ì „ ì˜í™” ì¤‘ì—ì„œ<br/>í‰ì ì´ ë†’ì€ ì‘í’ˆê³¼<br/>ë°°ìš°ë“¤ì˜ ë‹¤ë¥¸ ì‘í’ˆì„ ì•Œë ¤ì¤˜'")]
    end

    subgraph Orchestrator["ğŸ”„ movie_graph_search_orchestrator"]
        B["1ï¸âƒ£ Vector Search<br/>Neo4jVector.similarity_search()"]
        C["ìœ ì‚¬ ì˜í™” ì œëª© ì¶”ì¶œ<br/>(k=3)"]
        D["2ï¸âƒ£ Graph Search #1<br/>get_movie_details_and_actors()"]
        E["ì˜í™” ìƒì„¸ ì •ë³´ ì¡°íšŒ<br/>â€¢ title, released, rating<br/>â€¢ overview<br/>â€¢ actor_names, actor_ids"]
        F["3ï¸âƒ£ Actor ID ìˆ˜ì§‘<br/>(ì¤‘ë³µ ì œê±°)"]
        G["4ï¸âƒ£ Graph Search #2<br/>get_actor_filmography()"]
        H["ë°°ìš°ë³„ ë‹¤ë¥¸ ì¶œì—°ì‘ ì¡°íšŒ<br/>(ê²€ìƒ‰ëœ ì˜í™” ì œì™¸)"]
        I["5ï¸âƒ£ Context í¬ë§·íŒ…<br/>format_context_for_llm()"]
    end

    subgraph Neo4j["ğŸ—„ï¸ Neo4j Database"]
        V[("Vector Index<br/>movie_content_embeddings<br/>(overview ì„ë² ë”©)")]
        G1[("Graph Query 1<br/>MATCH (m:Movie)<br/>OPTIONAL MATCH<br/>(m)â†[:ACTED_IN]-(a:Person)")]
        G2[("Graph Query 2<br/>MATCH (a:Person)-[:ACTED_IN]â†’(m:Movie)<br/>WHERE NOT m.title IN exclude")]
    end

    subgraph RAGChain["â›“ï¸ LangChain RAG Chain"]
        J["rag_input ë”•ì…”ë„ˆë¦¬ êµ¬ì„±<br/>â€¢ context: ê²€ìƒ‰ ê²°ê³¼<br/>â€¢ question: ì›ë³¸ ì§ˆë¬¸"]
        K["ChatPromptTemplate<br/>ì˜í™” ì¶”ì²œ ì „ë¬¸ê°€ í”„ë¡¬í”„íŠ¸"]
        L["ChatOpenAI<br/>(gpt-4.1-mini)"]
        M["StrOutputParser"]
    end

    subgraph Output["ğŸ“¤ ì¶œë ¥"]
        N[("ìµœì¢… ë‹µë³€<br/>ì˜í™” ì •ë³´ + ë°°ìš° í•„ëª¨ê·¸ë˜í”¼<br/>ê¸°ë°˜ ì¶”ì²œ")]
    end

    %% ì—°ê²°
    A --> B
    B <--> V
    B --> C
    C --> D
    D <--> G1
    D --> E
    E --> F
    F --> G
    G <--> G2
    G --> H
    H --> I
    
    I --> J
    A --> J
    J --> K
    K --> L
    L --> M
    M --> N

    %% ìŠ¤íƒ€ì¼ë§
    style Input fill:#e1f5fe,stroke:#01579b
    style Orchestrator fill:#fff3e0,stroke:#e65100
    style Neo4j fill:#f3e5f5,stroke:#7b1fa2
    style RAGChain fill:#e8f5e9,stroke:#2e7d32
    style Output fill:#fce4ec,stroke:#c2185b
    
    style A fill:#bbdefb
    style N fill:#f8bbd9
    style V fill:#e1bee7
    style G1 fill:#e1bee7
    style G2 fill:#e1bee7
```